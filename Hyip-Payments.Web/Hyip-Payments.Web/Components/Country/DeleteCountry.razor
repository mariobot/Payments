@page "/country/delete/{id:int}"

@using Hyip_Payments.Models
@using MediatR
@inject NavigationManager NavigationManager
@inject IMediator Mediator

<h3>Delete Country</h3>

@if (!string.IsNullOrEmpty(successMessage))
{
    <div class="alert alert-success mt-3">@successMessage</div>
}
else
{
    <div class="alert alert-warning">
        Are you sure you want to delete this country?
    </div>
    <button class="btn btn-danger" @onclick="HandleDelete">Delete</button>
    <button class="btn btn-secondary" @onclick="GoBack">Cancel</button>
}

@code {
    [Parameter]
    public int id { get; set; }

    private string? successMessage;

    private async Task HandleDelete()
    {
        try
        {
            await Mediator.Send(new Hyip_Payments.Command.CountryCommand.DeleteCountryCommand(id));
            successMessage = "Country deleted successfully!";
            // Optionally, navigate away after deletion:
            // NavigationManager.NavigateTo("/country/list");
        }
        catch (Exception ex)
        {
            successMessage = $"Error: {ex.Message}";
        }
    }

    private void GoBack()
    {
        NavigationManager.NavigateTo("/country/list");
    }
}
